# Azure DNS

## what is DNS?

DNS (Domain Name System) is a service that translates human-readable domain names (like example.com) into IP addresses (like 192.168.1.1) that computers use to communicate. It acts like the internet’s phonebook, ensuring users can access websites and services using easy-to-remember names instead of numeric addresses.

## What is Azure DNS?

Azure DNS is a cloud-based Domain Name System (DNS) service provided by Microsoft Azure, allowing users to host their domain names and manage DNS records within the Azure platform, essentially translating human-readable domain names into IP addresses for easy access to websites and services.

### Key points about Azure DNS:

**Function:** It acts as a DNS hosting service, where you can create and manage DNS zones (collections of records for a specific domain) and record sets (individual records within a zone like A records pointing to IP addresses or CNAME records for aliases). 

## Key Features of Azure DNS

#### 1. Host DNS Domains in Azure

 -   Allows you to host public and private DNS zones for your domain names.
 -   Provides a fully managed DNS infrastructure with Microsoft’s global network.

#### 2. High Availability and Reliability

 -   99.99% uptime SLA ensures reliable domain resolution.
 -   Uses Anycast networking to direct queries to the nearest DNS server for faster responses.

#### 3. Public and Private DNS Zones

-    **Public DNS Zones**: Host DNS records for internet-facing domains (e.g., example.com).
-    **Private DNS Zones**: Used for internal domain resolution within Azure Virtual Networks (VNets).

#### 4. Secure and Role-Based Access Control (RBAC)

-    Uses Azure Active Directory (Azure AD) RBAC to manage access.
-    Ensures only authorized users can modify DNS records.

#### 5. Integration with Azure Services

 -   Works with Azure Virtual Networks (VNets) for internal DNS resolution.
 -   Integrates with Azure Traffic Manager for global traffic distribution and load balancing.

#### 6. Custom DNS Names for Azure Resources

 -   Assign custom domain names to Azure VMs, Storage Accounts, and Web Apps.
 -   Simplifies access to cloud resources with easy-to-remember names.

#### 7. DNS Record Management

#### Supports various DNS record types:

-    A Record (Maps domain to IP)
-    CNAME Record (Alias for another domain)
-    MX Record (Mail exchange for emails)
-    TXT Record (For domain verification)
-    SRV Record (Service location records)
-    NS Record (Delegates a subdomain to other DNS servers)

#### 8. Fast DNS Query Resolution

-    Uses Anycast DNS to route queries to the nearest available DNS server.
-    Reduces latency and improves performance.

#### 9. DNS Analytics and Monitoring

-    Monitors DNS query logs with Azure Monitor and Log Analytics.
-    Detects anomalies and security threats with Azure Security Center.


## Architecture diagram

![image](https://github.com/user-attachments/assets/f3028d5e-185e-4129-87fb-74143f617652)



## How to Use Azure DNS in Azure portal?

To configure Public DNS in Azure, follow these steps:

### 1. Create an Azure DNS Zone

- Sign in to Azure Portal (https://portal.azure.com)
- Search for "DNS Zones" in the search bar.
- Click "Create" to create a new DNS Zone.
![image](https://github.com/user-attachments/assets/9acc104d-dd71-41fa-87be-c33e8182e161)

- Click **"Review + Create"**, then **"Create".**

- **Note**:ranjitha.dreamteamit.in
- **dreamteamit.in**  : Domain Name bought from cloudflare(Third-party Domain registrar:cloudflare/godaddy etc.)
- **ranjitha**         : Sub-Domain Name
- **Azure**                : Domain Host
### 2. Configure DNS Records

After creating a DNS zone, add records for name resolution.

#### Adding DNS Records:

-    Open the DNS Zone you created **ranjitha.dreamteamit.in**
-    Click "+ Record Set" to add a new DNS record.

![image](https://github.com/user-attachments/assets/4dede1f4-dc0e-4b7d-97a1-c8a7f6d88cd5)

### Explanation of Record set

-  Enter the name (www or frontend or backend)
-  Enter Type (Refer above in Key Features of Azure DNS step-7)
-  Alias Record Set in Azure DNS

   -  An Alias Record Set is a special type of DNS record used in Azure DNS that maps a domain name to an Azure resource instead of a fixed IP address.
  
    ### Why Use Alias Record Sets?

    - They allow dynamic mapping to an Azure resource, so if the IP of the resource changes, the DNS record updates automatically.
    -  Unlike A records (which map to a fixed IP), Alias records map to Azure resources such as:
     1. Azure Public IP
     2. Azure Traffic Manager
     3. Azure Front Door
     4. Azure Content Delivery Network (CDN)

     5. **Example**
   - Without Alias Record:
        www.example.com → 20.244.57.15 (Static IP)
   - With Alias Record:
        www.example.com → Azure Traffic Manager (Automatically updates IP)

-  TTL 
 
     "TTL" stands for "Time to Live" and it defines how long a DNS record should be cached by a resolver before it needs to be re-queried from the DNS server; 
 
      **Example:**    Creating an A record with a TTL of 1 hour: When creating an A record for "www.example.com" in Azure DNS, you would specify a TTL value of "3600" which means that any device trying to resolve "www.example.com" will cache the IP address associated with it for 1 hour before requesting a fresh or new update from the DNS server.

- TTL Unit

     TTL unit specifies the time measurement unit for TTL values. Azure DNS supports TTL in seconds.

    **Default unit**: Seconds

   **Example**: 300 seconds (5 minutes) means the record is cached for 5 minutes before being refreshed.   

-    Enter ip address (Used Application gateway public ip-address created in previous task) that above name should map to this ip address.

-   Click "OK" to save.


- After adding names with ip address in record set

![image](https://github.com/user-attachments/assets/b0e031b4-2afc-407f-8680-4fcf99d59dbd)


### 3. Update Domain Registrar Settings

 If your domain is registered with a third-party provider (Cloudflare,GoDaddy, Namecheap, etc.), you need to update its nameservers.

### How Azure Public DNS Communicates with GoDaddy?

When you register a domain with cloudflare (or another domain registrar), you must link it to Azure DNS for DNS resolution.

- Step-by-Step Process of Communication:

-   Domain Registration in cloudflare:
 
     * You buy a domain (e.g., dreamteamit.in) from cloudflare.

-   Create a DNS Zone in Azure:

     * In Azure Portal, create a Public DNS Zone (ranjitha)for dreamteamit.in

     * Azure will generate Name Server (NS) records (e.g., ns1-xyz.azure-dns.com).

![image](https://github.com/user-attachments/assets/8eba9c3f-7825-42cc-b104-fbed253e6a2f)


-    Update Name Servers in cloudflare:

     *  Go to cloudflare DNS settings.

     *  Replace cloudflare’s default NS records with Azure’s NS records.

     *  This tells cloudflare that Azure DNS is now responsible for managing the domain.

-    Add DNS Records in Azure DNS:

     *  In Azure DNS Zone, create necessary records:

     *  A Record (Maps dreamteamit.in to an IP, e.g., 20.244.57.15).

     *  CNAME Record (Alias, e.g., www → dreamteamit.in).

  -  DNS Propagation:
  
      *  Changes take a few hours to propagate globally.

      * When a user enters dreamteamit.in, their browser queries cloudflare’s nameservers, which direct them to Azure DNS.

      *  Azure resolves the request and returns the correct IP address to the client.
   

### 4. Verify DNS Configuration

We can verify if DNS is correctly configured using:

```
nslookup www.ranjitha.dreamteamit.in
```
![Screenshot from 2025-02-27 21-08-40](https://github.com/user-attachments/assets/51abe234-e06a-4e2e-b8b0-6cb6a96f1b96)

 check in browwser
 ![Screenshot from 2025-02-27 21-09-22](https://github.com/user-attachments/assets/3f548e10-2171-45e1-a39d-f5721c2b398b)

```
dig www.ranjitha.dreamteamit.in
```
 
![Screenshot from 2025-02-27 21-10-32](https://github.com/user-attachments/assets/66f16940-38f6-4da3-b74c-0e802b55e021)

- By using Application gateway ip address we can check for frontend and backend applicaton is running

 * Before that check **vmss-frontend** and in Application gateway **Listener** port 80 is **Allow**

 ![image](https://github.com/user-attachments/assets/2baa4840-bb4c-493b-acfc-a3f8f32877fc)

 ![image](https://github.com/user-attachments/assets/8958ca38-095d-40ad-8b37-349d2dbdc490)


* Frontend Application add in record sets

![image](https://github.com/user-attachments/assets/a95325f1-c647-401a-89c7-3f12263741b0)

![image](https://github.com/user-attachments/assets/c68a1959-440c-49f7-b22c-d5fd1bc8c9a3)

output
![Screenshot from 2025-02-27 21-29-34](https://github.com/user-attachments/assets/c201a6ef-6827-4a0f-aa2f-3c3990b73470)

* Backend Application

 ![image](https://github.com/user-attachments/assets/e8fcae22-c88b-4548-beac-e471710dd5a8)

![image](https://github.com/user-attachments/assets/f4ac7dc5-b504-4df8-b46a-b4034812a561)

output

![Screenshot from 2025-02-27 21-27-21](https://github.com/user-attachments/assets/a0a3aad6-db43-4699-80ba-a61f4608387d)

## Workflow for above process

### Step-by-Step Workflow

### User Opens Your Website

  -  A user types ranjitha.dreamteamit.in in a browser.
  -  The browser needs to find the IP address.

### DNS Query Goes to Cloudflare

  -  Since your domain (dreamteamit.in) is managed by Cloudflare, the query first goes to Cloudflare’s DNS servers.
  -  Cloudflare checks if it has a cached IP. If yes, it returns the IP instantly.

### Cloudflare Forwards to Azure DNS

  -  If the IP is not cached, Cloudflare forwards the request to Azure DNS, where you created ranjitha.dreamteamit.in.

### Azure DNS Resolves the Domain

 -   A Record: ranjitha.dreamteamit.in → 20.244.57.15 (Frontend)
 -   Alias Record: backend.ranjitha.dreamteamit.in → Azure Application Gateway

### Azure Application Gateway Routes Traffic

 -   / → Frontend (Website UI) at 20.244.57.15:3000
 -   /api/v1/employees → Backend API at 20.244.57.15:8080

### User Sees the Website

 -   The browser loads your website from 20.244.57.15:3000.
 -   Backend API requests go to backend.ranjitha.dreamteamit.in/api/v1/employees.
 -   Website works perfectly!


## Enable Private DNS (For Internal Use)

Azure also provides Private DNS Zones for internal networking.

![image](https://github.com/user-attachments/assets/449b997b-9e59-464f-9a77-b0dfe754cb16)


**Steps for Private DNS:**

-    Navigate to Private DNS Zones in Azure.
-    Create a new Private DNS Zone (e.g., internal.example.com).
-    Link it to a Virtual Network (VNet) for internal resolution.








